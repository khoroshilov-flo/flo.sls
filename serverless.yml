service: khoroshilov-middy-0

provider:
  name: aws
  runtime: nodejs12.x
  environment:
    STAGE: ${opt:stage, self:provider.stage}
  region: ${file(env.yml):${opt:stage, self:provider.stage}.REGION}
  profile: ${file(env.yml):${opt:stage, self:provider.stage}.PROFILE}
  tags:
    client: ${file(env.yml):${opt:stage, self:provider.stage}.CLIENT}
  httpApi:
    payload: '2.0'

custom:
  dirconfig:
    quiet: true
  webpack:
    webpackConfig: 'webpack.config.js' # Name of webpack configuration file
    includeModules:
      packagePath: 'package.json'
      forceExclude:
        - aws-sdk
    packager: 'npm' # Packager that will be used to package your external modules
  prune:
    automatic: true
    number: 3
  envFiles: # YAML files used to create .env file
    - env.yml
  envEncryptionKeyId: # KMS Key used for encrypting values
    local: ${file(kms_key.yml):local} # Key used for local-stage
    dev: ${file(kms_key.yml):dev} # Key used for development-stage
    test: ${file(kms_key.yml):test} # Key used for test-stage
    prod: ${file(kms_key.yml):prod} # Key used for prod-stage

plugins: # order matters!
  - '@redtea/serverless-env-generator'
  - serverless-dir-config-plugin
  - serverless-webpack
  - serverless-offline
  - serverless-prune-plugin
